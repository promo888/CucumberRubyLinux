var AmEditorJS,AmEditorHTML,AmEditorCSS,AmEditorRES,AmRegExpJS=/"theme":[^"]*"([a-z]+)"/g,AmRegExpRES=/themes\/.*.js/,AmRegExpCSS=/#chartdiv.*/;jQuery(document).ready(function(){jQuery('.demo-body').each(function(){var editor_js=jQuery(this).find('#editor_js');var code_js=jQuery(this).find('#code_js')[0];var instance_js=CodeMirror(editor_js[0],{mode:"text/javascript",value:code_js.value,json:true,lineNumbers:true,lineWrapping:true});instance_js.on('change',function(){code_js.value=instance_js.getValue();});AmEditorJS=instance_js;var editor_html=jQuery(this).find('#editor_html');var code_html=jQuery(this).find('#code_html')[0];var instance_html=CodeMirror(editor_html[0],{mode:"text/html",value:code_html.value,lineNumbers:true,lineWrapping:true});instance_html.on('change',function(){code_html.value=instance_html.getValue();});AmEditorHTML=instance_html;var editor_css=jQuery(this).find('#editor_css');var code_css=jQuery(this).find('#code_css')[0];var instance_css=CodeMirror(editor_css[0],{mode:"text/css",value:code_css.value,lineNumbers:true,lineWrapping:true});instance_css.on('change',function(){code_css.value=instance_css.getValue();jQuery('#style_css').html('<style type="text/css">'+ code_css.value+'</style>');});AmEditorCSS=instance_css;var editor_resources=jQuery(this).find('#editor_resources');var code_resources=jQuery(this).find('#code_resources')[0];var instance_resources=CodeMirror(editor_resources[0],{mode:"text/html",value:code_resources.value,lineNumbers:true,lineWrapping:true});instance_resources.on('change',function(){code_resources.value=instance_resources.getValue();});AmEditorRES=instance_resources;function switchTheme(theme,evalCode){var code_HTML=AmEditorHTML.getValue();var code_JS=AmEditorJS.getValue();var code_CSS=AmEditorCSS.getValue();var code_RES=AmEditorRES.getValue();var current_CSS='';var themes=jQuery('.demo-themes li.demo-themes-item');theme=theme||jQuery(location.hash.split('-')).last()[0]||'light';if(themes.length==1){theme=jQuery(themes).data('theme');}
themes.each(function(id,li){var theme_name=jQuery(li).data('theme');var theme_css=jQuery(li).data('css');if(theme_name==theme){jQuery('.demo-flipper-front').attr('style',theme_css);jQuery(li).addClass('active');current_CSS=theme_css||'';}else{jQuery(li).removeClass('active');}});jQuery('.demo-nav-pages a, .app-demo-list a').each(function(){var href=jQuery(this).attr('href');href=href.replace(/#.*/,'#theme-'+ theme);href+=href.indexOf('#')>0?'':'#theme-'+ theme;jQuery(this).attr('href',href);});jQuery('#container_html').html(code_HTML);AmEditorJS.setValue(code_JS.replace(AmRegExpJS,'"theme": "'+ theme+'"'));AmEditorRES.setValue(code_RES.replace(AmRegExpRES,'themes/'+ theme+'.js'));AmEditorCSS.setValue(AmEditorCSS.getValue().replace(/@import.*\n/gm,''));if(!jQuery('.demo-flipper').hasClass('active')){var chartcode=AmEditorJS.getValue();if(AmCharts.charts.length)
AmCharts.charts[0].clear();eval(chartcode);if('undefined'!=typeof chart)
window.chartObject=chart;if('undefined'!=typeof map)
window.mapObject=map;if(chartcode.indexOf('AmCharts.ready')!=-1&&AmCharts.onReadyArray.length>0){AmCharts.onReadyArray.pop()();}}
var chalkFont='@import url(http://fonts.googleapis.com/css?family=Covered+By+Your+Grace);'
if(theme=='chalk'){AmEditorCSS.setValue(chalkFont+'\n'+ AmEditorCSS.getValue());}}
jQuery(document).bind('click.bs.tab.data-api',function(e){AmEditorJS.refresh();AmEditorHTML.refresh();AmEditorCSS.refresh();AmEditorRES.refresh();});jQuery(this).find('.demo-flipper-toggler').bind('click',function(){if(jQuery('.demo-flipper').toggleClass('active').hasClass('active')){jQuery(this).find('span').text('Run');}else{jQuery(this).find('span').text('Edit');var theme=AmEditorJS.getValue().match(AmRegExpJS)||['none'];switchTheme(theme[0].replace(/theme|[": ]/g,''));}});jQuery(this).find('.demo-flipper-jsfiddle').bind('click',function(){jQuery('#code_html')[0].value=AmEditorRES.getValue()+ AmEditorHTML.getValue();jQuery('#jsfiddle').trigger('submit');});jQuery(this).find('.demo-flipper-codepen').bind('click',function(){jQuery('#code_html')[0].value=AmEditorRES.getValue()+ AmEditorHTML.getValue();jQuery('#codepen-form').remove();var form=jQuery('<form>').attr({'method':'post','id':'codepen-form','target':'_blank','action':'http://codepen.io/pen/define'}).css('display','none').appendTo('body');var field=jQuery('<input>').attr({'type':'hidden','name':'data','value':JSON.stringify({'title':jQuery('#code_title').val(),'description':jQuery('#code_description').val(),'html':jQuery('#code_html').val(),'js':jQuery('#code_js').val(),'css':jQuery('#code_css').val(),'js_external':'https://code.jquery.com/jquery-1.11.2.min.js'})});form.append(field).submit();});jQuery('.demo-themes li.demo-themes-item').bind('click',function(){var theme_name=jQuery(this).data('theme');switchTheme(theme_name);});function applyBGtoExport(instance){setTimeout(function(){if(window.fabric){if(instance&&instance["export"]){instance["export"].config.fabric.backgroundColor=jQuery('.demo-flipper-front').css("backgroundColor")||"#FFFFFF";}}else{applyBGtoExport(instance);}},500);}
AmCharts.addInitHandler(function(instance){instance.addListener("rendered",function(e){applyBGtoExport(e.chart);});},["pie","serial","xy","funnel","radar","gauge","stock","map","gantt"]);switchTheme();});});